extends layout

block content
    script.
        function incrementa(id){
            var current = document.getElementById(id);
            if (current.value < current.max)
                document.getElementById(id).value++;
        }
        function decrementa(id) {
            var current = document.getElementById(id);
            if(current.value > 1)
                document.getElementById(id).value--;
        }
        function toggleElement(id) {
            $('#'+id).toggle();
        }

        function resetForm(formId){
            document.forms[formId].reset();
        }
    .row
        .col-xs-12.col-sm-12.col-md-6.col-lg-3
            button(type='button' id="btnNewSale" onclick="toggleElement('newSale');toggleElement('btnDeleteSale');toggleElement('btnNewSale');").btn.btn-success.active.center-block
                text.h4
                    | Nuova Vendita
            button(type='button' id="btnDeleteSale" style="display: none;" onclick="toggleElement('newSale');toggleElement('btnDeleteSale');toggleElement('btnNewSale');resetForm('saleForm');").btn.btn-danger.active.center-block
                text.h4
                    | Annulla
            br
        .col-xs-12.col-sm-12.col-md-8.col-lg-9
            form(id='saleForm',action="/user/addSale",method="post").form-inline
                input(type="hidden" name="tipoTransazione" value="vendo")
                div(style="display: none;" id='newSale')
                    .form-group
                        label(for='inputOggetto').col-lg-3.control-label Nome:
                        .col-lg-3
                            select(id="inputOggetto" name="oggetto" required).form-control
                                option(value="" selected disabled)
                                    | Scegli Ortaggio
                                each oggetto in user.orto
                                    option(value="#{oggetto}")
                                        | #{oggetto}
                    .form-group
                        label(for='inputQuantita').col-lg-3.control-label Quantità:
                        .col-lg-3
                            input(type='number' id='inputQuantita' name='quantita' placeholder='Quantita' required).form-control
                    .form-group
                        .col-lg-6
                            button(type='submit').btn.btn-success
                                | VENDI
    .row
        br
        each oggetto in magazzino
            .col-xs-9.col-xs-offset-2.col-sm-9.col-sm-offset-3.col-md-3.col-md-offset-2.col-lg-3.col-lg-offset-1
                a(data-toggle='modal' style='cursor:pointer;' data-target='#ortaggiModal#{oggetto._id}')
                    if oggetto.immagine
                        img(src='#{oggetto.immagine}' style='width:200px;height:200px;' alt='...').img-circle.img-responsive
                    else
                        img(src='/imgOggetti/img_not_found.jpg' style='width:200px;height:200px;' alt='...').img-circle.img-responsive
                    #{oggetto.nome}
                div(class='modal fade' tabindex='-1' role='dialog' id='ortaggiModal#{oggetto._id}' aria-labelledby='ortaggiModalLabel#{oggetto._id}')
                    div(class='modal-dialog' role='document')
                        form(action="/user/addSale",method="post").form-inline
                            .modal-content
                                .modal-header
                                    h4(id='ortaggiModalLabel#{oggetto._id}').modal-title #{oggetto.nome}
                                .modal-body
                                    .row
                                        .col-md-4
                                            | Quantità disponibile: #{oggetto.quantita}
                                        .col-md-4
                                            | Prezzo: #{oggetto.costo}
                                        .col-md-6
                                            | Scegli la quantità:
                                            input(type='number' id='#{oggetto._id}' value='1' name='quantita' min='1' max='#{oggetto.quantita}').form-control
                                .modal-footer
                                    button(type='button' class='btn btn-danger pull-left' data-dismiss='modal') Close
                                    input(type="hidden" name="oggetto" value="#{oggetto.nome}")
                                    input(type="hidden" name="tipoTransazione" value="acquisto")
                                    button(type='submit' class='btn btn-success')
                                        | Acquista
                br
                br